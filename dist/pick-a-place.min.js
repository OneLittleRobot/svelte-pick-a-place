var PickAPlace=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function a(t){t.forEach(n)}function r(t){return"function"==typeof t}function l(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function o(t,n){t.appendChild(n)}function c(t,n,e){t.insertBefore(n,e||null)}function i(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function s(t){return document.createTextNode(t)}function d(){return s(" ")}function f(t,n,e,a){return t.addEventListener(n,e,a),()=>t.removeEventListener(n,e,a)}function p(t){return function(n){return n.stopPropagation(),t.call(this,n)}}function g(t,n){n=""+n,t.data!==n&&(t.data=n)}let m;function $(t){m=t}function v(){if(!m)throw new Error("Function called outside component initialization");return m}function h(){const t=m;return(n,e)=>{const a=t.$$.callbacks[n];if(a){const r=function(t,n){const e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,n),e}(n,e);a.slice().forEach(n=>{n.call(t,r)})}}}function b(t){return v().$$.context.get(t)}function y(t,n){const e=t.$$.callbacks[n.type];e&&e.slice().forEach(t=>t(n))}const _=[],k=Promise.resolve();let x=!1;const O=[],E=[],w=[];function M(t){E.push(t)}function C(){const t=new Set;do{for(;_.length;){const t=_.shift();$(t),N(t.$$)}for(;O.length;)O.shift()();for(;E.length;){const n=E.pop();t.has(n)||(n(),t.add(n))}}while(_.length);for(;w.length;)w.pop()();x=!1}function N(t){t.fragment&&(t.update(t.dirty),a(t.before_render),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_render.forEach(M))}let z;function F(){z={remaining:0,callbacks:[]}}function P(){z.remaining||a(z.callbacks)}function A(t){z.callbacks.push(t)}function S(t,e,l){const{fragment:o,on_mount:c,on_destroy:i,after_render:u}=t.$$;o.m(e,l),M(()=>{const e=c.map(n).filter(r);i?i.push(...e):a(e),t.$$.on_mount=[]}),u.forEach(M)}function T(t,n){t.$$.dirty||(_.push(t),x||(x=!0,k.then(C)),t.$$.dirty=e()),t.$$.dirty[n]=!0}function j(n,r,l,o,c,i){const u=m;$(n);const s=r.props||{},d=n.$$={fragment:null,ctx:null,props:i,update:t,not_equal:c,bound:e(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(u?u.$$.context:[]),callbacks:e(),dirty:null};let f=!1;d.ctx=l?l(n,s,(t,e)=>{d.ctx&&c(d.ctx[t],d.ctx[t]=e)&&(d.bound[t]&&d.bound[t](e),f&&T(n,t))}):s,d.update(),f=!0,a(d.before_render),d.fragment=o(d.ctx),r.target&&(r.hydrate?d.fragment.l(function(t){return Array.from(t.childNodes)}(r.target)):d.fragment.c(),r.intro&&n.$$.fragment.i&&n.$$.fragment.i(),S(n,r.target,r.anchor),C()),$(u)}class q{$destroy(){var n,e;e=!0,(n=this).$$&&(a(n.$$.on_destroy),n.$$.fragment.d(e),n.$$.on_destroy=n.$$.fragment=null,n.$$.ctx={}),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(){}}function B(n){return{c:t,m:t,p:t,i:t,o:t,d:t}}function U(t,n,e){const{getMap:a,getLeaflet:r}=b("leaflet");let l,{lat:o,lng:c}=n,i=a(),u=r();var s;return s=()=>{l&&i.removeLayer(l)},v().$$.on_destroy.push(s),t.$set=t=>{"lat"in t&&e("lat",o=t.lat),"lng"in t&&e("lng",c=t.lng)},t.$$.update=(t={lat:1,lng:1,marker:1,leaflet:1,map:1})=>{(t.lat||t.lng||t.marker||t.leaflet||t.map)&&(o&&c?l?l.setLatLng([o,c]):e("marker",l=u.marker([o,c]).addTo(i)):l&&i.removeLayer(l))},{lat:o,lng:c}}class V extends q{constructor(t){super(),j(this,t,U,B,l,["lat","lng"])}}function Y(t){var n,e=new V({props:{lat:t.lat,lng:t.lng}});return{c(){e.$$.fragment.c()},m(t,a){S(e,t,a),n=!0},p(t,n){var a={};t.lat&&(a.lat=n.lat),t.lng&&(a.lng=n.lng),e.$set(a)},i(t){n||(e.$$.fragment.i(t),n=!0)},o(t){e.$$.fragment.o(t),n=!1},d(t){e.$destroy(t)}}}function Z(t){var n;function e(t){return t.lat&&t.lng?G:D}var a=e(t),r=a(t);return{c(){n=u("div"),r.c(),n.className="pick-a-place__guide-panel"},m(t,e){c(t,n,e),r.m(n,null)},p(t,l){a===(a=e(l))&&r?r.p(t,l):(r.d(1),(r=a(l))&&(r.c(),r.m(n,null)))},d(t){t&&i(n),r.d()}}}function D(n){var e;return{c(){(e=u("span")).textContent="Click the map to select a position"},m(t,n){c(t,e,n)},p:t,d(t){t&&i(e)}}}function G(t){var n,e,a,r,l,d=t.lat.toFixed(5),f=t.lng.toFixed(5);return{c(){n=u("span"),e=s("Latitude: "),a=s(d),r=s(" Longitude: "),l=s(f)},m(t,i){c(t,n,i),o(n,e),o(n,a),o(n,r),o(n,l)},p(t,n){t.lat&&d!==(d=n.lat.toFixed(5))&&g(a,d),t.lng&&f!==(f=n.lng.toFixed(5))&&g(l,f)},d(t){t&&i(n)}}}function H(t){var n,e,r,l,g,m,$;return{c(){n=u("div"),(e=u("button")).textContent="Cancel",r=d(),l=u("button"),g=s("Use location"),l.disabled=m=!(t.lat&&t.lng),n.className="pick-a-place__button-panel",$=[f(e,"click",p(t.click_handler)),f(l,"click",p(t.click_handler_1))]},m(t,a){c(t,n,a),o(n,e),o(n,r),o(n,l),o(l,g)},p(t,n){(t.lat||t.lng)&&m!==(m=!(n.lat&&n.lng))&&(l.disabled=m)},d(t){t&&i(n),a($)}}}function I(t){var n,e,a,r,l=t.lat&&t.lng&&Y(t),o=t.guideOverlay&&Z(t),u=t.buttons&&H(t);return{c(){l&&l.c(),n=d(),o&&o.c(),e=d(),u&&u.c(),a=s("")},m(t,i){l&&l.m(t,i),c(t,n,i),o&&o.m(t,i),c(t,e,i),u&&u.m(t,i),c(t,a,i),r=!0},p(t,r){r.lat&&r.lng?l?(l.p(t,r),l.i(1)):((l=Y(r)).c(),l.i(1),l.m(n.parentNode,n)):l&&(F(),A(()=>{l.d(1),l=null}),l.o(1),P()),r.guideOverlay?o?o.p(t,r):((o=Z(r)).c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),r.buttons?u?u.p(t,r):((u=H(r)).c(),u.m(a.parentNode,a)):u&&(u.d(1),u=null)},i(t){r||(l&&l.i(),r=!0)},o(t){l&&l.o(),r=!1},d(t){l&&l.d(t),t&&i(n),o&&o.d(t),t&&i(e),u&&u.d(t),t&&i(a)}}}function J(t,n,e){let a,r,{placeMarker:l=!0,guideOverlay:o=!0,buttons:c=!0}=n;const i=h(),{getMap:u}=b("leaflet");return u().on("click",t=>{e("lat",a=t.latlng.lat),e("lng",r=t.latlng.lng),i("update",t.latlng)}),t.$set=t=>{"placeMarker"in t&&e("placeMarker",l=t.placeMarker),"guideOverlay"in t&&e("guideOverlay",o=t.guideOverlay),"buttons"in t&&e("buttons",c=t.buttons)},{placeMarker:l,guideOverlay:o,buttons:c,lat:a,lng:r,dispatch:i,click_handler:function(){return i("cancel")},click_handler_1:function(){return i("save",{lat:a,lng:r})}}}class K extends q{constructor(t){super(),j(this,t,J,I,l,["placeMarker","guideOverlay","buttons"])}}function Q(t){var n,e=new K({props:{guideOverlay:t.guideOverlay,buttons:t.buttons}});return e.$on("update",t.update_handler),e.$on("save",t.save_handler),e.$on("cancel",t.cancel_handler),{c(){e.$$.fragment.c()},m(t,a){S(e,t,a),n=!0},p(t,n){var a={};t.guideOverlay&&(a.guideOverlay=n.guideOverlay),t.buttons&&(a.buttons=n.buttons),e.$set(a)},i(t){n||(e.$$.fragment.i(t),n=!0)},o(t){e.$$.fragment.o(t),n=!1},d(t){e.$destroy(t)}}}function R(t){var n,e,a=t.map&&Q(t);return{c(){n=u("div"),a&&a.c(),n.className="pick-a-place svelte-cdihq2"},m(r,l){var o;c(r,n,l),a&&a.m(n,null),o=()=>t.div_binding(n,null),O.push(o),e=!0},p(t,e){e.map?a?(a.p(t,e),a.i(1)):((a=Q(e)).c(),a.i(1),a.m(n,null)):a&&(F(),A(()=>{a.d(1),a=null}),a.o(1),P()),t.items&&(e.div_binding(null,n),e.div_binding(n,null))},i(t){e||(a&&a.i(),e=!0)},o(t){a&&a.o(),e=!1},d(e){e&&i(n),a&&a.d(),t.div_binding(null,n)}}}function W(t,n,e){let{leaflet:a,lat:r=45,lng:l=0,zoom:o=3,guideOverlay:c=!0,buttons:i=!0}=n;var u,s;let d,f;var p;return u="leaflet",s={getMap:()=>f,getLeaflet:()=>a},v().$$.context.set(u,s),p=()=>{if(null==a)throw new Error("No Leaflet instance was provided.");e("map",f=a.map(d).setView([r,l],o)),L.tileLayer("https://a.tile.openstreetmap.org/{z}/{x}/{y}.png ",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',maxZoom:18}).addTo(f)},v().$$.on_mount.push(p),t.$set=t=>{"leaflet"in t&&e("leaflet",a=t.leaflet),"lat"in t&&e("lat",r=t.lat),"lng"in t&&e("lng",l=t.lng),"zoom"in t&&e("zoom",o=t.zoom),"guideOverlay"in t&&e("guideOverlay",c=t.guideOverlay),"buttons"in t&&e("buttons",i=t.buttons)},{leaflet:a,lat:r,lng:l,zoom:o,guideOverlay:c,buttons:i,mapElement:d,map:f,update_handler:function(n){y(t,n)},save_handler:function(n){y(t,n)},cancel_handler:function(n){y(t,n)},div_binding:function(t,n){e("mapElement",d=t)}}}return class extends q{constructor(t){super(),j(this,t,W,R,l,["leaflet","lat","lng","zoom","guideOverlay","buttons"])}}}();
