var PickAPlace=function(){"use strict";function t(){}function n(t,n){for(const e in n)t[e]=n[e];return t}function e(t){return t()}function a(){return Object.create(null)}function l(t){t.forEach(e)}function r(t){return"function"==typeof t}function o(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function c(t,e,a){return t[1]?n({},n(e.$$scope.ctx,t[1](a?a(e):{}))):e.$$scope.ctx}function i(t,n){t.appendChild(n)}function u(t,n,e){t.insertBefore(n,e||null)}function s(t){t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function f(){return p(" ")}function g(t,n,e,a){return t.addEventListener(n,e,a),()=>t.removeEventListener(n,e,a)}function $(t){return function(n){return n.stopPropagation(),t.call(this,n)}}function m(t,n){n=""+n,t.data!==n&&(t.data=n)}let v;function h(t){v=t}function y(){if(!v)throw new Error("Function called outside component initialization");return v}function b(){const t=v;return(n,e)=>{const a=t.$$.callbacks[n];if(a){const l=function(t,n){const e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,n),e}(n,e);a.slice().forEach(n=>{n.call(t,l)})}}}function _(t){return y().$$.context.get(t)}function k(t,n){const e=t.$$.callbacks[n.type];e&&e.slice().forEach(t=>t(n))}const x=[],O=Promise.resolve();let E=!1;const w=[],M=[],N=[];function C(t){M.push(t)}function z(){const t=new Set;do{for(;x.length;){const t=x.shift();h(t),F(t.$$)}for(;w.length;)w.shift()();for(;M.length;){const n=M.pop();t.has(n)||(n(),t.add(n))}}while(x.length);for(;N.length;)N.pop()();E=!1}function F(t){t.fragment&&(t.update(t.dirty),l(t.before_render),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_render.forEach(C))}let P;function j(){P={remaining:0,callbacks:[]}}function A(){P.remaining||l(P.callbacks)}function S(t){P.callbacks.push(t)}function T(t,n,a){const{fragment:o,on_mount:c,on_destroy:i,after_render:u}=t.$$;o.m(n,a),C(()=>{const n=c.map(e).filter(r);i?i.push(...n):l(n),t.$$.on_mount=[]}),u.forEach(C)}function B(t,n){t.$$.dirty||(x.push(t),E||(E=!0,O.then(z)),t.$$.dirty=a()),t.$$.dirty[n]=!0}function q(n,e,r,o,c,i){const u=v;h(n);const s=e.props||{},d=n.$$={fragment:null,ctx:null,props:i,update:t,not_equal:c,bound:a(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(u?u.$$.context:[]),callbacks:a(),dirty:null};let p=!1;d.ctx=r?r(n,s,(t,e)=>{d.ctx&&c(d.ctx[t],d.ctx[t]=e)&&(d.bound[t]&&d.bound[t](e),p&&B(n,t))}):s,d.update(),p=!0,l(d.before_render),d.fragment=o(d.ctx),e.target&&(e.hydrate?d.fragment.l(function(t){return Array.from(t.childNodes)}(e.target)):d.fragment.c(),e.intro&&n.$$.fragment.i&&n.$$.fragment.i(),T(n,e.target,e.anchor),z()),h(u)}class U{$destroy(){var n,e;e=!0,(n=this).$$&&(l(n.$$.on_destroy),n.$$.fragment.d(e),n.$$.on_destroy=n.$$.fragment=null,n.$$.ctx={}),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(){}}function V(n){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Y(t,n,e){const{getMap:a,getLeaflet:l}=_("leaflet");let r,{lat:o,lng:c}=n,i=a(),u=l();var s;return s=()=>{r&&i.removeLayer(r)},y().$$.on_destroy.push(s),t.$set=t=>{"lat"in t&&e("lat",o=t.lat),"lng"in t&&e("lng",c=t.lng)},t.$$.update=(t={lat:1,lng:1,marker:1,leaflet:1,map:1})=>{(t.lat||t.lng||t.marker||t.leaflet||t.map)&&(o&&c?r?r.setLatLng([o,c]):e("marker",r=u.marker([o,c]).addTo(i)):r&&i.removeLayer(r))},{lat:o,lng:c}}class Z extends U{constructor(t){super(),q(this,t,Y,V,o,["lat","lng"])}}function D(t){var n,e=new Z({props:{lat:t.lat,lng:t.lng}});return{c(){e.$$.fragment.c()},m(t,a){T(e,t,a),n=!0},p(t,n){var a={};t.lat&&(a.lat=n.lat),t.lng&&(a.lng=n.lng),e.$set(a)},i(t){n||(e.$$.fragment.i(t),n=!0)},o(t){e.$$.fragment.o(t),n=!1},d(t){e.$destroy(t)}}}function G(t){var n;function e(t){return t.lat&&t.lng?I:H}var a=e(t),l=a(t);return{c(){n=d("div"),l.c(),n.className="pick-a-place__guide-panel"},m(t,e){u(t,n,e),l.m(n,null)},p(t,r){a===(a=e(r))&&l?l.p(t,r):(l.d(1),(l=a(r))&&(l.c(),l.m(n,null)))},d(t){t&&s(n),l.d()}}}function H(n){var e;return{c(){(e=d("span")).textContent="Click the map to select a position"},m(t,n){u(t,e,n)},p:t,d(t){t&&s(e)}}}function I(t){var n,e,a,l,r,o=t.lat.toFixed(5),c=t.lng.toFixed(5);return{c(){n=d("span"),e=p("Latitude: "),a=p(o),l=p(" Longitude: "),r=p(c)},m(t,o){u(t,n,o),i(n,e),i(n,a),i(n,l),i(n,r)},p(t,n){t.lat&&o!==(o=n.lat.toFixed(5))&&m(a,o),t.lng&&c!==(c=n.lng.toFixed(5))&&m(r,c)},d(t){t&&s(n)}}}function J(t){var n,e,a,r,o,c,m;return{c(){n=d("div"),(e=d("button")).textContent="Cancel",a=f(),r=d("button"),o=p("Use location"),r.disabled=c=!(t.lat&&t.lng),n.className="pick-a-place__button-panel",m=[g(e,"click",$(t.click_handler)),g(r,"click",$(t.click_handler_1))]},m(t,l){u(t,n,l),i(n,e),i(n,a),i(n,r),i(r,o)},p(t,n){(t.lat||t.lng)&&c!==(c=!(n.lat&&n.lng))&&(r.disabled=c)},d(t){t&&s(n),l(m)}}}function K(t){var n,e,a,l,r=t.lat&&t.lng&&D(t),o=t.guideOverlay&&G(t),c=t.buttons&&J(t);return{c(){r&&r.c(),n=f(),o&&o.c(),e=f(),c&&c.c(),a=p("")},m(t,i){r&&r.m(t,i),u(t,n,i),o&&o.m(t,i),u(t,e,i),c&&c.m(t,i),u(t,a,i),l=!0},p(t,l){l.lat&&l.lng?r?(r.p(t,l),r.i(1)):((r=D(l)).c(),r.i(1),r.m(n.parentNode,n)):r&&(j(),S(()=>{r.d(1),r=null}),r.o(1),A()),l.guideOverlay?o?o.p(t,l):((o=G(l)).c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),l.buttons?c?c.p(t,l):((c=J(l)).c(),c.m(a.parentNode,a)):c&&(c.d(1),c=null)},i(t){l||(r&&r.i(),l=!0)},o(t){r&&r.o(),l=!1},d(t){r&&r.d(t),t&&s(n),o&&o.d(t),t&&s(e),c&&c.d(t),t&&s(a)}}}function Q(t,n,e){let a,l,{placeMarker:r=!0,guideOverlay:o=!0,buttons:c=!0}=n;const i=b(),{getMap:u}=_("leaflet");return u().on("click",t=>{e("lat",a=t.latlng.lat),e("lng",l=t.latlng.lng),i("update",t.latlng)}),t.$set=t=>{"placeMarker"in t&&e("placeMarker",r=t.placeMarker),"guideOverlay"in t&&e("guideOverlay",o=t.guideOverlay),"buttons"in t&&e("buttons",c=t.buttons)},{placeMarker:r,guideOverlay:o,buttons:c,lat:a,lng:l,dispatch:i,click_handler:function(){return i("cancel")},click_handler_1:function(){return i("save",{lat:a,lng:l})}}}class R extends U{constructor(t){super(),q(this,t,Q,K,o,["placeMarker","guideOverlay","buttons"])}}function W(t){var n,e=new R({props:{guideOverlay:t.guideOverlay,buttons:t.buttons}});return e.$on("update",t.update_handler),e.$on("save",t.save_handler),e.$on("cancel",t.cancel_handler),{c(){e.$$.fragment.c()},m(t,a){T(e,t,a),n=!0},p(t,n){var a={};t.guideOverlay&&(a.guideOverlay=n.guideOverlay),t.buttons&&(a.buttons=n.buttons),e.$set(a)},i(t){n||(e.$$.fragment.i(t),n=!0)},o(t){e.$$.fragment.o(t),n=!1},d(t){e.$destroy(t)}}}function X(t){var e,a,l,r,o;const p=t.$$slots.default,g=function(t,n,e){if(t){const a=c(t,n,e);return t[0](a)}}(p,t,null);var $=t.map&&W(t);return{c(){e=d("div"),a=d("div"),l=d("div"),g&&g.c(),r=f(),$&&$.c(),l.className="pick-a-place__overlay-content",a.className="pick-a-place__overlay-container",e.className="pick-a-place svelte-itmjy5"},l(t){g&&g.l(div0_nodes)},m(n,c){var s;u(n,e,c),i(e,a),i(a,l),g&&g.m(l,null),i(l,r),$&&$.m(l,null),s=()=>t.div2_binding(e,null),w.push(s),o=!0},p(t,a){g&&g.p&&t.$$scope&&g.p(function(t,e,a,l){return t[1]?n({},n(e.$$scope.changed||{},t[1](l?l(a):{}))):e.$$scope.changed||{}}(p,a,t,null),c(p,a,null)),a.map?$?($.p(t,a),$.i(1)):(($=W(a)).c(),$.i(1),$.m(l,null)):$&&(j(),S(()=>{$.d(1),$=null}),$.o(1),A()),t.items&&(a.div2_binding(null,e),a.div2_binding(e,null))},i(t){o||(g&&g.i&&g.i(t),$&&$.i(),o=!0)},o(t){g&&g.o&&g.o(t),$&&$.o(),o=!1},d(n){n&&s(e),g&&g.d(n),$&&$.d(),t.div2_binding(null,e)}}}function tt(t,n,e){let{leaflet:a,lat:l=45,lng:r=0,zoom:o=3,guideOverlay:c=!0,buttons:i=!0}=n;var u,s;let d,p;var f;u="leaflet",s={getMap:()=>p,getLeaflet:()=>a},y().$$.context.set(u,s),f=()=>{if(null==a)throw new Error("No Leaflet instance was provided.");e("map",p=a.map(d).setView([l,r],o)),L.tileLayer("https://a.tile.openstreetmap.org/{z}/{x}/{y}.png ",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',maxZoom:18}).addTo(p)},y().$$.on_mount.push(f);let{$$slots:g={},$$scope:$}=n;return t.$set=t=>{"leaflet"in t&&e("leaflet",a=t.leaflet),"lat"in t&&e("lat",l=t.lat),"lng"in t&&e("lng",r=t.lng),"zoom"in t&&e("zoom",o=t.zoom),"guideOverlay"in t&&e("guideOverlay",c=t.guideOverlay),"buttons"in t&&e("buttons",i=t.buttons),"$$scope"in t&&e("$$scope",$=t.$$scope)},{leaflet:a,lat:l,lng:r,zoom:o,guideOverlay:c,buttons:i,mapElement:d,map:p,update_handler:function(n){k(t,n)},save_handler:function(n){k(t,n)},cancel_handler:function(n){k(t,n)},div2_binding:function(t,n){e("mapElement",d=t)},$$slots:g,$$scope:$}}return class extends U{constructor(t){super(),q(this,t,tt,X,o,["leaflet","lat","lng","zoom","guideOverlay","buttons"])}}}();
